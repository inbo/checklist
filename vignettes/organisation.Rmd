---
title: "Organisations"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Organisations}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
bibliography: references.bib
---

```{r setup, include = FALSE}
library(knitr)
opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

## What is an `organisation` in the `checklist` context

The `organisation` object defines rules about the organisation related to the project (or package).
`checklist` assumes by default that a project is a part of the [Research Institute for Nature and Forest (INBO)](https://www.vlaanderen.be/inbo/).
And it will enforce to mention INBO as copyright holder and funder.

Such a rule limits the use of `checklist` outside of INBO.
Therefore we added the `organisation` object.
It contains the following elements:

- [GitHub](https://github.com) organisation
- copyright holder
- funder
- organisation e-mail
- [Zenodo](https://zenodo.org) community
- a list of organisation affiliations

The organisation affiliations must be a named list using the email domain names as names.
Every element is a list containing the elements `affiliation` and `orcid`.
`affiliation` is a character vector with one or more allowed organisation names.
Use multiple values to add optional translations of the organisation name.
`orcid` must be either `TRUE` or `FALSE`.
Setting `orcid` to `TRUE` requires every author with matching e-mail to have an [ORCID](https://orcid.org/) number.

## Defining a specific `organisation` for a project

First generate the object with `organisation$new()`.
Then store this object in your project with `write_organisation()`.
The function stores the information in `organisation.yml`, a plain text file in YAML format.

```{r}
library(checklist)
# create a dummy project
my_project_path <- tempfile("my_project")
dir.create(my_project_path)
# create an organisation object
org <- organisation$new(
  rightsholder = "Vlaamse overheid", funder = "Vlaamse overheid",
  email = "info@vlaanderen.be", github = "vlaanderen",
  community = NA_character_,
  organisation = list(
    "vlaanderen.be" = list(
      affiliation = "Vlaamse overheid", orcid = FALSE
    )
  )
)
# store the organisation in the dummy project
write_organisation(org, my_project_path)
```

## Defining a default `organisation` object for your machine

Store the organisation as a default with `default_organisation(org = org)`.

Whenever `checklist` needs the `organisation` information, it will retrieve it with `read_organisation()`.
It first looks at project root folder for the `organisation.yml` file.
When missing it looks for the machines default `organisation.yml`.
In this case it will copy the machines default `organisation.yml` into the project.
Hence the `organisation` information is a part of the project, which is required to use the information during checks on other machines.
When `read_organisation()` finds neither a project `organisation.yml` nor a machines default `organisation.yml`, it reverts to the INBO `organisation`.

## Technical requirements

- shall: required
- should: recommended but optional

### Items

- An item shall be either a single person or a single organisation.
- Every item shall have at least one attribute from this list:
    - author
    - maintainer
    - contributor
    - copyright holder
    - funder

### Organisations

- An organisation shall have a single default language and a single name for that language.
- An organisation shall have a root domain name.
  E.g. `inbo.be` or `vlaanderen.be`.
- An organisation should have a single name for other languages.
- An organisation should have a single email.
- An organisation should have a single [ROR](https://ror.org/) number.
- An organisation should have a [Zenodo community](https://help.zenodo.org/docs/communities/).
- An organisation should have a git organisation name as an absolute URL.
  E.g. https://github.com/inbo

### Persons

- A person shall have a given name and a family name.
- A person should have a single [ORCID](https://orcid.org) number.
- A person should have one or more email.
- A person should have one or more one or more affiliations.
- A persons affiliation shall match the organisation name for the project language.
- A person shall be liked to an organisation based on the domain name of the persons email and the organisation domain name.

### Information stored in the `organisation.yml` file

- The fill shall contain one or more organisations.
- One organisation shall be marked as the primary organisation.
- The primary organisation shall have a git organisation name as an absolute URL.
- The primary organisation should define if the `DESCRIPTION` or `README.md` file shall have at least one copyright holder.
- The primary organisation should define if the `DESCRIPTION` or `README.md` file shall have at least one funder.
- Every organisation should indicate whether is shall be used as copyright holder.
- Every organisation should indicate whether other items shall not be used as copyright holder.
  Using another item as copyright holder shall return an error.
- Every organisation should indicate whether other items should not be used as copyright holder.
  Using another item as copyright holder shall return a warning.
- Every organisation should indicate whether is shall be used as funder.
- Every organisation should indicate whether other items shall not be used as funder.
  Using another item as funder shall return an error.
- Every organisation should indicate whether other items should not be used as funder.
  Using another item as funder shall return a warning.
- Every organisation should indicate whether every person in its organisation shall have a [ORCID](https://orcid.org) number.
- The rules in the `organisation.yml` file of a project repository shall abide all rules define in the organisations `checklist` repository `organisation.yml` file.
  This is is ignored when not checking via a GitHub Action or when the organisation has no `checklist` repository.
- The `organisation.yml` file of a project repository should define more strict rules that the rules define in the organisations `checklist` repository `organisation.yml` file.

### Citation information stored in the `DESCRIPTION` or `README.md` file

- The fill shall contain a language attribute.
- The file shall contain at least one item.
- One item shall have the maintainer attribute.
- One or more items should have the copyright holder attribute.
- One or more items should have the funder attribute.
- When the organisation provides an email, an [ROR](https://ror.org/) number or Zenodo community; then the `DESCRIPTION` or `README.md` file in every project shall have that information listed with the name of the organisation.
